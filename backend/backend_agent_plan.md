# üìò –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è –ê–≥–µ–Ω—Ç–∞ –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ backend (—Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è —è–¥—Ä–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏)

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥—ë–Ω —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –ø–æ—à–∞–≥–æ–≤—ã–π, –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è –ê–≥–µ–Ω—Ç–∞ (AI-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞), –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–∑–¥–∞—Ç—å backend-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞. –ü–ª–∞–Ω –æ–ø–∏—Å—ã–≤–∞–µ—Ç:
- –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É;
- –ª–æ–≥–∏–∫—É –º–æ–¥—É–ª–µ–π;
- –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞—Ç—å;
- –∫–∞–∫–∏–µ —Ä—É—á–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å;
- –∫–∞–∫ –≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —è–¥—Ä–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏;
- –∫–∞–∫–∏–µ –∑–∞–≥–ª—É—à–∫–∏ –∏ –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

---

# üß© **1. –û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è backend**
Backend –¥–æ–ª–∂–µ–Ω:
1. –ü—Ä–∏–Ω–∏–º–∞—Ç—å —Ñ–∞–π–ª—ã XLSX –æ—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞.
2. –ü–∞—Ä—Å–∏—Ç—å –∏—Ö –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–æ–≤–∞—Ä–æ–≤.
3. –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–º in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.
4. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å API –¥–ª—è —Å–ø–∏—Å–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤, –¥–µ—Ç–∞–ª–µ–π —Ç–æ–≤–∞—Ä–∞, –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ç–æ–≤–∞—Ä–∞.
5. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ –∏ –µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞.
6. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å API –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø (–∫–ª–∞—Å—Ç–µ—Ä–æ–≤).
7. –ò–º–µ—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å-—è–¥—Ä–æ (–ø–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞), –∫—É–¥–∞ –ø–æ–∑–∂–µ –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω ML/–∞–ª–≥–æ—Ä–∏—Ç–º –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.
8. –ë—ã—Ç—å –∑–∞–≤–µ—Ä–Ω—É—Ç—ã–º –≤ Docker.

---

# üèó **2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:
```
backend/
  app/
    api/
      products.py
      upload.py
      groups.py
      variants.py
    core/
      config.py
    models/
      product.py
      group.py
    services/
      storage.py
      parser.py
      grouping_core_stub.py
    main.py
  data/
    uploaded/
    temp/
  requirements.txt
  Dockerfile
```

–û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π:
- **api/** ‚Äî FastAPI-—Ä–æ—É—Ç–µ—Ä—ã –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤, –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –∏ –≥—Ä—É–ø–ø.
- **models/** ‚Äî Pydantic-–º–æ–¥–µ–ª–∏ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤, –≥—Ä—É–ø–ø –∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.
- **services/**:
  - storage.py ‚Äî in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.
  - parser.py ‚Äî –ø–∞—Ä—Å–µ—Ä XLSX.
  - grouping_core_stub.py ‚Äî –∑–∞–≥–ª—É—à–∫–∞ –±—É–¥—É—â–µ–≥–æ ML/—è–¥—Ä–∞.
- **core/** ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
- **main.py** ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI.

---

# üìÑ **3. –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞—Ç—å**
## –§–∞–π–ª—ã API
- `api/upload.py`
- `api/products.py`
- `api/groups.py`
- `api/variants.py`

## –°–µ—Ä–≤–∏—Å—ã
- `services/storage.py`
- `services/parser.py`
- `services/grouping_core_stub.py`

## –ú–æ–¥–µ–ª–∏
- `models/product.py`
- `models/group.py`

## –û—Å—Ç–∞–ª—å–Ω–æ–µ
- `main.py`
- `requirements.txt`
- `Dockerfile`

---

# üîå **4. –õ–æ–≥–∏–∫–∞ –º–æ–¥—É–ª–µ–π (—á—Ç–æ –ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å)**

## **4.1. storage.py ‚Äî In-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**
–ê–≥–µ–Ω—Ç —Å–æ–∑–¥–∞—ë—Ç –∫–ª–∞—Å—Å Storage c –ø–æ–ª—è–º–∏:
- `products: Dict[int, Product]`
- `groups: Dict[int, ProductGroup]`
- –º–µ—Ç–æ–¥—ã:
  - add_products(list)
  - get_filtered(filters)
  - update_product(id, data)
  - delete_product(id)
  - add_variant(product_id)
  - update_variant
  - delete_variant

–í –¥–∞–ª—å–Ω–µ–π—à–µ–º —ç—Ç–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ Postgres.

---

## **4.2. parser.py ‚Äî –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ XLSX**
–ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:
- —á—Ç–µ–Ω–∏–µ Excel —á–µ—Ä–µ–∑ pandas
- –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ–ª—è ¬´—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏¬ª –≤ —Å—Ç—Ä–æ–∫—É ‚Üí dict
- —Å–±–æ—Ä —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π Product
- —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ storage

---

## **4.3. grouping_core_stub.py ‚Äî –ó–∞–≥–ª—É—à–∫–∞ —è–¥—Ä–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏**
–ê–≥–µ–Ω—Ç —Å–æ–∑–¥–∞—ë—Ç –∫–ª–∞—Å—Å GroupingCore —Å –º–µ—Ç–æ–¥–∞–º–∏:
- `determine_significant_features(products)` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–µ–π–∫–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
- `group_products(products)` ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–µ–π–∫–æ–≤—ã–µ –≥—Ä—É–ø–ø—ã —Å ID, –Ω–∞–∑–≤–∞–Ω–∏–µ–º –∏ score
- –æ–±—ä–µ–∫—Ç `core = GroupingCore()`

–ü–æ–∑–∂–µ —Å—é–¥–∞ –≤—Å—Ç–∞–≤–∏—Ç—Å—è –Ω–∞—Å—Ç–æ—è—â–µ–µ ML-—è–¥—Ä–æ.

---

# üî• **5. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è API (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ä—É—á–∫–∏)**

## **5.1. /api/upload** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ XLSX
POST `/api/upload`
- –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∞–π–ª
- –ø–∞—Ä—Å–∏—Ç
- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã
- –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{status, loaded}`

## **5.2. /api/products** ‚Äî —Å–ø–∏—Å–æ–∫
GET `/api/products?q&limit&offset`
- –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{items, total}`

## **5.3. /api/products/{id}** ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞
GET `/api/products/{id}`

## **5.4. /api/products/{id} (PUT)** ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
PUT `/api/products/{id}`
- –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç

## **5.5. /api/products/{id} (DELETE)** ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ
DELETE `/api/products/{id}`

## **5.6. /api/products/{id}/variants** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–∞
POST ‚Äî —Å–æ–∑–¥–∞—ë—Ç –∫–æ–ø–∏—é –∫–∞—Ä—Ç–æ—á–∫–∏

## **5.7. /api/products/{id}/variants/{variant_id}** ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ
PUT / DELETE

---

## **5.8. /api/groups/generate** ‚Äî –∑–∞–ø—É—Å–∫ —è–¥—Ä–∞
POST `/api/groups/generate`
- –≤—ã–∑—ã–≤–∞–µ—Ç grouping_core_stub.group_products
- —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## **5.9. /api/groups** ‚Äî —Å–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø
GET `/api/groups`

## **5.10. /api/groups/{id}`** ‚Äî –¥–µ—Ç–∞–ª–∏ –≥—Ä—É–ø–ø—ã
GET `/api/groups/{id}`

---

# üì¶ **6. requirements.txt**
–ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
- fastapi
- NumPy 
- pandas
- python-multipart

---

# üê≥ **7. Dockerfile**
–ê–≥–µ–Ω—Ç —Å–æ–∑–¥–∞—ë—Ç Dockerfile:
- python:3.11-slim
- –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- —É—Å—Ç–∞–Ω–æ–≤–∫–∞
- –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- –∑–∞–ø—É—Å–∫ uvicorn

---

# ‚öôÔ∏è **8. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ**
–ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω:
- —Å–æ–±–ª—é–¥–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –∫–æ–¥
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥–ª—É—à–∫—É —è–¥—Ä–∞
- –ø–∏—Å–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ
- —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç
- –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º (upload, list, detail, variants, groups)

---

# üî• **9. –ß—Ç–æ –ø–æ–∑–∂–µ –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–æ –≤ —è–¥—Ä–æ (—á—Ç–æ–±—ã –ê–≥–µ–Ω—Ç –æ—Å—Ç–∞–≤–∏–ª —Ö—É–∫–∏)**
–ê–≥–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∏—Ç—å –≥–æ—Ç–æ–≤—ã–µ –º–µ—Å—Ç–∞ –¥–ª—è:
- –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ (–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏)
- –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–∏–º—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
- –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫

`
–í grouping_core_stub.py —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á—ë—Ç–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã, —á—Ç–æ–±—ã –∑–∞–º–µ–Ω–∏—Ç—å—Å—è –Ω–∞—Å—Ç–æ—è—â–∏–º–∏.
`

---

# üöÄ **10. –†–µ–∑—É–ª—å—Ç–∞—Ç**
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞–Ω–∞ –ê–≥–µ–Ω—Ç —Å–æ–∑–¥–∞—Å—Ç:
- –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π backend
- —Ä–∞–±–æ—á–∏–µ API
- –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É XLSX
- –º–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- –∑–∞–≥–ª—É—à–∫—É —è–¥—Ä–∞
- –≥–æ—Ç–æ–≤—ã–π docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

Backend –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –º–æ–¥—É–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.

